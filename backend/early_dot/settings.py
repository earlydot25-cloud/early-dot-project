"""
Django settings for early_dot project.

Generated by 'django-admin startproject' using Django 5.2.7.

For more information on this file, see
https://docs.djangoproject.com/en/5.2/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/5.2/ref/settings/
"""

from pathlib import Path
import environ
import os
# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent

MEDIA_ROOT = BASE_DIR / "media"
MEDIA_URL = "/media/"

# =============================================
# ğŸ“„ .env í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ
# =============================================
env = environ.Env(DEBUG=(bool, False))
environ.Env.read_env(
    env_file=os.path.join(os.path.dirname(os.path.dirname(os.path.abspath(__file__))), ".env")
)

SECRET_KEY = env("Django_SECRET_KEY")
DEBUG = env("DEBUG")

# =============================================
# âš™ï¸ ì•± ì„¤ì •
# =============================================
INSTALLED_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "django.contrib.sites",

    # ğŸ”¹ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬
    "rest_framework",
    "rest_framework_simplejwt",
    "corsheaders",

    # ğŸ”¹ ë¡œì»¬ ì•±
    "users",
    "diagnosis",
    "dashboard",
    "admin_tools",
]

#SITE_ID ì„¤ì • ì¶”ê°€ (django.contrib.sitesë¥¼ ì‚¬ìš©í•˜ë©´ í•„ìˆ˜)
SITE_ID = 1
AUTH_USER_MODEL = "users.Users"

# ì»¤ìŠ¤í…€ ìœ ì € ì‚¬ìš©
AUTH_USER_MODEL = 'users.Users'

MIDDLEWARE = [
    "corsheaders.middleware.CorsMiddleware",          # âœ… ë°˜ë“œì‹œ ê°€ì¥ ìœ„
    "django.middleware.security.SecurityMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
]

ROOT_URLCONF = 'early_dot.urls'

TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
            ],
        },
    },
]

WSGI_APPLICATION = "early_dot.wsgi.application"

# =============================================
# ğŸ—„ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
# =============================================
DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.mysql",
        "NAME": env("DB_NAME"),
        "USER": env("DB_USER"),
        "PASSWORD": env("DB_PASSWORD"),
        "HOST": env("DB_HOST", default="127.0.0.1"),
        "PORT": env("DB_PORT", default="3306"),
    }
}

# =============================================
# ğŸ” ë¹„ë°€ë²ˆí˜¸ ê²€ì¦
# =============================================

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    #{ ì´ê±° ë””ì¥ê³  ìì²´ì ìœ¼ë¡œ ë¹„ë²ˆ ì œì•½ ê±¸ì–´ë†“ëŠ” ë¶€ë¶„ì¸ë°, ì œì•½ì´ ë„ˆë¬´ ë¹¡ì„¸ì„œ ì¼ë‹¨ ë¹¼ë†“ìŒ
    #    'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    #},
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]
# =============================================
# ğŸŒ êµ­ì œí™” ì„¤ì •
# =============================================
LANGUAGE_CODE = "en-us"
TIME_ZONE = "UTC"
USE_I18N = True

USE_TZ = True

# =============================================
# ğŸ“¦ ì •ì  íŒŒì¼ ì„¤ì •
# =============================================
STATIC_URL = "static/"

DEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"

# =============================================
# ğŸ”‘ REST Framework ê¸°ë³¸ ì„¤ì •
# =============================================
REST_FRAMEWORK = {
    # ğŸ”´ ì´ ë¶€ë¶„ì„ ì„ì‹œë¡œ ì£¼ì„ ì²˜ë¦¬í•˜ê±°ë‚˜ AllowAnyë¡œ ë³€ê²½
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework_simplejwt.authentication.JWTAuthentication',
    ),
    'DEFAULT_PERMISSION_CLASSES': [
        # 'rest_framework.permissions.IsAuthenticated', # ğŸš¨ ì£¼ì„ ì²˜ë¦¬ ë˜ëŠ” ì œê±°
        'rest_framework.permissions.AllowAny',  # ğŸ’¡ ì„ì‹œë¡œ AllowAnyë¡œ ë³€ê²½
    ]
}

# -------------------------------------------------------------------
# ğŸ’¡ ë¦¬ì•¡íŠ¸ FE ì—°ë™ì„ ìœ„í•œ CORS ì„¤ì •
# -------------------------------------------------------------------

# [ê¸°ë³¸ê°’: ë¡œì»¬ë§Œ í—ˆìš©]
#ALLOWED_HOSTS = ["127.0.0.1", "localhost", "*"]    #<- mac ê¸°ì¤€ìœ¼ë¡œ ì´ê±° ì£¼ì„ í’€ê³ , ì•„ë˜ ì£¼ì„ ë‹¬ë©´ ë¨.
ALLOWED_HOSTS = ["127.0.0.1", "localhost"]

# ëª¨ë“  í˜¸ìŠ¤íŠ¸ë¥¼ í—ˆìš©í•©ë‹ˆë‹¤ (ë°°í¬ ì‹œì—ëŠ” íŠ¹ì • ë„ë©”ì¸ìœ¼ë¡œ ì œí•œí•´ì•¼ í•©ë‹ˆë‹¤).
CORS_ALLOW_ALL_ORIGINS = True   # ê°œë°œ í•œì •ì„
#CORS_ALLOW_ALL_ORIGINS = False

# ë¡œì»¬ FE ì˜¤ë¦¬ì§„ë§Œ í—ˆìš©
CORS_ALLOWED_ORIGINS = [
    "http://localhost:3000",
    "http://127.0.0.1:3000",
    "http://localhost:5173",
    "http://127.0.0.1:5173",
    # ë„¤íŠ¸ì›Œí¬(IP) ë°”ë€Œì–´ë„ ì ‘ì†ë˜ê²Œ í•˜ë ¤ë©´ .local ì¶”ê°€(ì£¼ì„ í•´ì œ)
    # sondongbin-ui-MacBookPro ìœ¼ë¡œ ë˜ì–´ ìˆëŠ” ë¶€ë¶„ì´ mac ì‚¬ìš©ìì˜ macbook ì´ë¦„ì´ ë“¤ì–´ê°€ë©´ ë¨,
    #"http://sondongbin-ui-MacBookPro.local:3000",
    #"http://sondongbin-ui-MacBookPro.local:5173",
]

# CSRF ì‹ ë¢° ì˜¤ë¦¬ì§„
CSRF_TRUSTED_ORIGINS = [
    "http://localhost:3000",
    "http://127.0.0.1:3000",
    "http://localhost:5173",
    "http://127.0.0.1:5173",
    # ë„¤íŠ¸ì›Œí¬(IP) ë°”ë€Œì–´ë„ ì ‘ì†ë˜ê²Œ í•˜ë ¤ë©´ .local ì¶”ê°€(ì£¼ì„ í•´ì œ)
    # sondongbin-ui-MacBookPro ìœ¼ë¡œ ë˜ì–´ ìˆëŠ” ë¶€ë¶„ì´ mac ì‚¬ìš©ìì˜ macbook ì´ë¦„ì´ ë“¤ì–´ê°€ë©´ ë¨,
    #http://sondongbin-ui-MacBookPro.local:3000",
    #http://sondongbin-ui-MacBookPro.local:5173",
]